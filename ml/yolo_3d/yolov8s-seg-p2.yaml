# Ultralytics YOLO ğŸš€, AGPL-3.0 license
# YOLOv8s-seg with P2 head (optimized for 960px input)

# å‚æ•°è®¾ç½®
nc: 3  # å¿…é¡»ä¿®æ”¹ï¼šå¯¹åº” pinhole, crap, spatter
scales: 
  s: [0.33, 0.50, 1024] # [depth, width, max_channels]

# YOLOv8 éª¨å¹²ç½‘ç»œ (Backbone)
backbone:
  # [from, repeats, module, args]
  - [-1, 1, Conv, [64, 3, 2]]  # 0-P1/2  (480x480)
  - [-1, 1, Conv, [128, 3, 2]] # 1-P2/4  (240x240)
  - [-1, 3, C2f, [128, True]]  # 2-ç‰¹å¾ä¿ç•™å±‚
  - [-1, 1, Conv, [256, 3, 2]] # 3-P3/8  (120x120)
  - [-1, 6, C2f, [256, True]]  # 4
  - [-1, 1, Conv, [512, 3, 2]] # 5-P4/16 (60x60)
  - [-1, 6, C2f, [512, True]]  # 6
  - [-1, 1, Conv, [1024, 3, 2]] # 7-P5/32 (30x30)
  - [-1, 3, C2f, [1024, True]] # 8
  - [-1, 1, SPPF, [1024, 5]]   # 9

# YOLOv8 æ£€æµ‹å¤´ (Head)
head:
  - [-1, 1, nn.Upsample, [None, 2, 'nearest']] # 10 (60x60)
  - [[-1, 6], 1, Concat, [1]]  # 11 èåˆ P4
  - [-1, 3, C2f, [512]]        # 12

  - [-1, 1, nn.Upsample, [None, 2, 'nearest']] # 13 (120x120)
  - [[-1, 4], 1, Concat, [1]]  # 14 èåˆ P3
  - [-1, 3, C2f, [256]]        # 15 (P3 æ£€æµ‹åŸºç¡€)

  # --- å…³é”®ä¿®æ”¹ï¼šå¢åŠ  P2 æ£€æµ‹åˆ†æ”¯ ---
  - [-1, 1, nn.Upsample, [None, 2, 'nearest']] # 16 (240x240)
  - [[-1, 2], 1, Concat, [1]]  # 17 èåˆ Backbone ä¸­çš„ P2
  - [-1, 3, C2f, [128]]        # 18 (P2/4 æå°ç›®æ ‡å¤´)

  - [-1, 1, Conv, [128, 3, 2]] # 19 å›åˆ° P3 (120x120)
  - [[-1, 15], 1, Concat, [1]] # 20
  - [-1, 3, C2f, [256]]        # 21

  - [-1, 1, Conv, [256, 3, 2]] # 22 å›åˆ° P4 (60x60)
  - [[-1, 12], 1, Concat, [1]] # 23
  - [-1, 3, C2f, [512]]        # 24

  - [-1, 1, Conv, [512, 3, 2]] # 25 å›åˆ° P5 (30x30)
  - [[-1, 9], 1, Concat, [1]]  # 26
  - [-1, 3, C2f, [1024]]       # 27

  # ä¿®æ”¹æ£€æµ‹è¾“å‡ºå±‚ï¼šåŠ å…¥ç¬¬ 18 å±‚ (P2)
  - [[18, 21, 24, 27], 1, Segment, [nc, 32, 256]] #